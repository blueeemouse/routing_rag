# routing_rag 项目开发进度

## 项目目标

构建一个可以支持检索方式routing的RAG系统，可以选择的是不用RAG/用naive RAG/用graphRAG。输入的query需要先进行分解，得到sub-query（当然，有可能遇到已经分解不了的情况）。各个sub-query会依次被routing到对应的检索方式中。目标是性能和成本的权衡。

## 架构设计

- **组件可替换性**: naive RAG、graphRAG、router、decomposer的实现都应该是可替换的
- **配置驱动**: 通过settings.yaml配置文件灵活切换不同实现
- **模块化**: 各组件遵循接口约定，便于开发和测试

## 当前进度

### 已完成任务

1. **基础架构搭建** - 完成

   - 查询分解器（Decomposer）接口定义和实现
   - 路由器（Router）接口定义和实现
   - RAG接口定义
   - 配置管理系统（settings.yaml, config.py）
   - Naive RAG基础实现
   - Graph RAG框架搭建
2. **测试验证** - 完成

   - Decomposer和Router的功能测试
   - Naive RAG与LlamaIndex集成测试
   - Graph RAG库导入验证测试
   - Graph RAG配置加载测试
3. **GraphRAG库集成** - 完成

   - 微软GraphRAG库导入和可用性检查
   - 配置参数从settings.yaml映射到GraphRAG
   - build_index方法实现（已修正参数命名）
   - 配置系统深入理解（root_dir参数、路径解析机制等）
4. **GraphRAG本地搜索功能完善** - 完成

   - 修复"sequence item 0: expected str instance, int found"错误
   - 实现了数据的正确类型转换（整数ID转字符串等）
   - 成功构建了GraphRAG搜索引擎
   - 成功执行查询并返回有用答案
   - 解决了DataFrame到GraphRAG实体类对象的转换问题

### 正在进行的任务

- GraphRAG查询功能完善（搜索方法待集成到execute方法）

### 下一步计划

1. **GraphRAG功能完善**

   - 完善GraphRAG的execute方法，使其能够调用_local_search(即集成execute与_local_search方法)
   - 实现其它的search方法
   - 把api-url也改成用环境变量指定的形式吧
2. **编排器实现**

   - 在orchestrator中连接所有组件
   - 实现完整的pipeline：查询 → 分解 → 路由 → 执行 → 合并结果
3. **完整流程测试**

   - 确保整个流程能运行起来
   - 通过settings.yaml配置文件灵活切换不同实现
4. **性能优化和扩展**

   - 优化各组件性能
   - 准备后续可能的组件替换实现

## 组件状态

- **Decomposer**: 基础LLM API调用版本已实现
- **Router**: 基础LLM API调用版本已实现
- **Naive RAG**: 基础LlamaIndex版本已实现，但存在一些运行时错误需要修复
- **GraphRAG**: 框架已搭建，库导入完成，索引功能已完成（参数名已修正）
- **Orchestrator**: 需要实现（当前为空文件）

## 配置管理

- 通过settings.yaml配置文件管理所有组件的参数
- 支持环境变量覆盖配置
- 配置热加载准备就绪
- 微软GraphRAG配置：理解了root_dir参数含义（项目根目录，相对路径的基准点）

## 当前版本日期

2025年12月5日
